
CREATE TABLE emp (
    emp_no NUMBER PRIMARY KEY,
    salary NUMBER(10,2)
);

CREATE TABLE increment_salary (
    emp_no NUMBER,
    salary NUMBER(10,2)
);

INSERT INTO emp VALUES (1, 25000);
INSERT INTO emp VALUES (2, 32000);
INSERT INTO emp VALUES (3, 18000);
INSERT INTO emp VALUES (4, 27000);
INSERT INTO emp VALUES (5, 40000);
COMMIT;

SET SERVEROUTPUT ON;

DECLARE
    v_avg_sal NUMBER;
BEGIN
    SELECT AVG(salary) INTO v_avg_sal FROM emp;

    FOR r IN (SELECT emp_no, salary FROM emp WHERE salary < v_avg_sal) LOOP
        UPDATE emp
        SET salary = salary + (salary * 0.10)
        WHERE emp_no = r.emp_no;

        INSERT INTO increment_salary (emp_no, salary)
        VALUES (r.emp_no, r.salary * 1.10);

        DBMS_OUTPUT.PUT_LINE('Salary increased by 10% for Employee No: ' || r.emp_no);
    END LOOP;

    COMMIT;
    DBMS_OUTPUT.PUT_LINE('Salary update completed.');
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
        ROLLBACK;
END;
/

SELECT * FROM emp;
SELECT * FROM increment_salary;